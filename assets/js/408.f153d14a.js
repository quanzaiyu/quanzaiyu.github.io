(window.webpackJsonp=window.webpackJsonp||[]).push([[408],{862:function(t,s,a){"use strict";a.r(s);var n={props:["slot-key"],mounted(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},_=a(0),v=Object(_.a)(n,function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[a("h1",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),a("p",[a("strong",[t._v("配置文件路径")])]),t._v(" "),a("p",[t._v("在 ThinkPHP5.0 中，配置文件位于 "),a("code",[t._v("application/config.php")]),t._v(" 中。\n在 ThinkPHP5.1 中，配置文件位于 "),a("code",[t._v("config")]),t._v(" 目录下。")]),t._v(" "),a("p",[a("strong",[t._v("配置格式")])]),t._v(" "),a("p",[t._v("除了 .php 的配置文件外，ThinkPHP 还支持以下配置格式:")]),t._v(" "),a("p",[t._v(".xml、.json、.yaml、.ini")]),t._v(" "),a("p",[a("strong",[t._v("配置文件")])]),t._v(" "),a("p",[t._v("在 ThinkPHP5.1 中，配置文件作用如下 :")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("配置文件名")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("app.php")]),t._v(" "),a("td",[t._v("应用配置")])]),t._v(" "),a("tr",[a("td",[t._v("cache.php")]),t._v(" "),a("td",[t._v("缓存配置")])]),t._v(" "),a("tr",[a("td",[t._v("cookie.php")]),t._v(" "),a("td",[t._v("Cookie配置")])]),t._v(" "),a("tr",[a("td",[t._v("database.php")]),t._v(" "),a("td",[t._v("数据库配置")])]),t._v(" "),a("tr",[a("td",[t._v("log.php")]),t._v(" "),a("td",[t._v("日志配置")])]),t._v(" "),a("tr",[a("td",[t._v("session.php")]),t._v(" "),a("td",[t._v("Session配置")])]),t._v(" "),a("tr",[a("td",[t._v("template.php")]),t._v(" "),a("td",[t._v("模板引擎配置")])]),t._v(" "),a("tr",[a("td",[t._v("trace.php")]),t._v(" "),a("td",[t._v("页面Trace配置")])]),t._v(" "),a("tr",[a("td",[t._v("paginate.php")]),t._v(" "),a("td",[t._v("分页配置")])])])]),t._v(" "),a("h2",{attrs:{id:"扩展配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩展配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 扩展配置")]),t._v(" "),a("p",[t._v("扩展配置位于 "),a("code",[t._v("application/extra")]),t._v(" 目录中，系统会默认加载里面的配置文件。")]),t._v(" "),a("p",[t._v("比如创建一个文件 "),a("code",[t._v("application/extra/myconfig.php")])]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'site_name'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'小昱个人网站'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'site_author'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'qzy'")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("在控制器的方法中获取，将文件名作为一级键值，跟上此文件下的配置名:")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("config")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'myconfig.site_name'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"配置文件的优先级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件的优先级","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置文件的优先级")]),t._v(" "),a("p",[t._v("ThinkPHP 默认会自动加载配置文件，但配置文件有加载优先级。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("惯例配置 < 应用配置 < 扩展配置 < 场景配置 < 模块配置 < 动态配置\n")])])]),a("p",[a("strong",[t._v("惯例配置")])]),t._v(" "),a("p",[t._v("位于 "),a("code",[t._v("thinkphp/convention.php")])]),t._v(" "),a("p",[a("strong",[t._v("应用配置")])]),t._v(" "),a("p",[t._v("位于 "),a("code",[t._v("application/config.php")])]),t._v(" "),a("p",[a("strong",[t._v("扩展配置")])]),t._v(" "),a("p",[t._v("位于 "),a("code",[t._v("application/extra")]),t._v(" 目录下")]),t._v(" "),a("p",[a("strong",[t._v("场景配置")])]),t._v(" "),a("p",[t._v("首先在 "),a("code",[t._v("application/config.php")]),t._v(" 中的 "),a("code",[t._v("app_status")]),t._v(" 选项中指定场景，比如 :")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("app_status "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'dev'")]),t._v("\n")])])]),a("p",[t._v("则只需在 "),a("code",[t._v("application")]),t._v(" 目录下新建一个同名的场景配置文件，即 "),a("code",[t._v("dev.php")]),t._v(" 即可。")]),t._v(" "),a("p",[a("strong",[t._v("模块配置")])]),t._v(" "),a("p",[t._v("比如在 "),a("code",[t._v("application/index")]),t._v(" 模块下，新增一个 "),a("code",[t._v("config.php")]),t._v(" 的配置文件，完整路径为 "),a("code",[t._v("application/index/config.php")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("动态配置")])]),t._v(" "),a("p",[t._v("可以在控制器或模型中，通过 "),a("code",[t._v("\\think\\Config::set()")]),t._v(" 进行配置。")]),t._v(" "),a("h2",{attrs:{id:"配置作用域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置作用域","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置作用域")]),t._v(" "),a("p",[t._v("相当于给配置加一个命名空间，用于配置的隔离。")]),t._v(" "),a("p",[t._v("加载配置")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("Config"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("load")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'配置文件的绝对路径'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'配置项名称'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'作用域的名称'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("如")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("Config"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("load")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token constant"}},[t._v("APP_PATH")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'my_config.php'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'test'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'user'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("其中 "),a("code",[t._v("APP_PATH")]),t._v(" 定位会到 "),a("code",[t._v("application")]),t._v(" 目录下。")]),t._v(" "),a("p",[t._v("再使用")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[t._v("Config"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token function"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("''")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'作用域名称'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("加载此作用域下的所有配置。此时，所有的配置将加载到指定的配置项名称下，这里是 test。")]),t._v(" "),a("h2",{attrs:{id:"优化配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化配置文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 优化配置文件")]),t._v(" "),a("p",[t._v("在 ThinkPHP5.0 中，配置文件没被拆分，可以通过在入口文件中使用 CONF_PATH 中指定配置文件存放的目录。")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("public/index.php")]),t._v(" 中定义 :")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("define")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'CONF_PATH'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token constant"}},[t._v("__DIR__")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'/../config'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("此时，我们需要在项目根目录下建立 "),a("code",[t._v("config")]),t._v(" 文件夹，来管理配置文件。")]),t._v(" "),a("blockquote",[a("p",[t._v("默认情况下，配置文件目录与应用程序目录相同，即 "),a("code",[t._v("application")]),t._v(" 下。")])]),t._v(" "),a("p",[t._v("在 ThinkPHP5.1 中，不需要任何更改，"),a("code",[t._v("config")]),t._v(" 目录已经分离。")])])},[],!1,null,null,null);v.options.__file="README.md";s.default=v.exports}}]);