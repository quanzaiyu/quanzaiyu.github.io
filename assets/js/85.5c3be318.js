(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{469:function(s,t,a){"use strict";a.r(t);var n={props:["slot-key"],mounted(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},e=a(0),r=Object(e.a)(n,function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.slotKey}},[a("h1",{attrs:{id:"用户和群组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户和群组","aria-hidden":"true"}},[s._v("#")]),s._v(" 用户和群组")]),s._v(" "),a("h2",{attrs:{id:"linux-用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-用户","aria-hidden":"true"}},[s._v("#")]),s._v(" Linux 用户")]),s._v(" "),a("p",[s._v("Linux用 户分为：拥有者、组群(Group)、其他（other），Linux系统中，预设的情況下，系统中所有的帐号与一般身份使用者，以及root的相关信 息， 都是记录在"),a("code",[s._v("/etc/passwd")]),s._v("文件中。每个人的密码则是记录在"),a("code",[s._v("/etc/shadow")]),s._v("文件下。 此外，所有的组群名称记录在"),a("code",[s._v("/etc/group")]),s._v("內！")]),s._v(" "),a("p",[s._v("linux文件的用户权限的分析图")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.xiaoyulive.top/img/articles/008.gif",alt:""}})]),s._v(" "),a("p",[s._v("例：rwx　rw-　r--  // 值 764")]),s._v(" "),a("ul",[a("li",[s._v("r=读取属性\t// 值＝4")]),s._v(" "),a("li",[s._v("w=写入属性\t// 值＝2")]),s._v(" "),a("li",[s._v("x=执行属性\t// 值＝1")])]),s._v(" "),a("p",[s._v("第一个字符意义")]),s._v(" "),a("ul",[a("li",[s._v("d=目录")]),s._v(" "),a("li",[s._v("l=软链接")])]),s._v(" "),a("p",[s._v("例: "),a("code",[s._v("lrwxrwxrwx. 1 root root 1 Apr 1 01:18 d -> b")])]),s._v(" "),a("h2",{attrs:{id:"创建和删除新用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建和删除新用户","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建和删除新用户")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("adduser username")]),s._v(" 添加用户")]),s._v(" "),a("li",[a("code",[s._v("passwd username")]),s._v(" 修改用户口令")]),s._v(" "),a("li",[a("code",[s._v("userdel -r username")]),s._v(" 删除一个用户 ( '-r' 排除主目录)")])]),s._v(" "),a("h2",{attrs:{id:"更改用户设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更改用户设置","aria-hidden":"true"}},[s._v("#")]),s._v(" 更改用户设置")]),s._v(" "),a("p",[a("code",[s._v("usermod")]),s._v(" 命令用于修改用户的基本信息。usermod命令不允许你改变正在线上的使用者帐号名称。当usermod命令用来改变user id，必须确认这名user没在电脑上执行任何程序。")]),s._v(" "),a("p",[a("strong",[s._v("选项")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-c<备注>")]),s._v(" 修改用户帐号的备注文字；")]),s._v(" "),a("li",[a("strong",[s._v("-d<登入目录>")]),s._v(" 修改用户登入时的目录；")]),s._v(" "),a("li",[a("strong",[s._v("-e<有效期限>")]),s._v(" 修改帐号的有效期限；")]),s._v(" "),a("li",[a("strong",[s._v("-f<缓冲天数>")]),s._v(" 修改在密码过期后多少天即关闭该帐号；")])]),s._v(" "),a("hr"),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-g<群组>")]),s._v(" 修改用户所属的群组；")]),s._v(" "),a("li",[a("strong",[s._v("-G<群组>")]),s._v(" 修改用户所属的附加群组；")])]),s._v(" "),a("hr"),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-u<uid>")]),s._v(" 修改用户ID；")]),s._v(" "),a("li",[a("strong",[s._v("-s<shell>")]),s._v(" 修改用户登入后所使用的shell；")])]),s._v(" "),a("hr"),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-l<帐号名称>")]),s._v(" 修改用户帐号名称；")])]),s._v(" "),a("hr"),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-L")]),s._v(" 锁定用户密码，使密码无效；")]),s._v(" "),a("li",[a("strong",[s._v("-U")]),s._v(" 解除密码锁定；")])]),s._v(" "),a("p",[a("strong",[s._v("参数")])]),s._v(" "),a("p",[s._v("登录名：指定要修改信息的用户登录名。")]),s._v(" "),a("p",[a("strong",[s._v("实例")])]),s._v(" "),a("p",[s._v("将 newuser 添加到组staff中")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -G staff newuser\n")])])]),a("p",[s._v("修改用户名为")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -l newuser1 newuser\n")])])]),a("p",[s._v("锁定/解锁账号")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -L newuser1\n$ "),a("span",{attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -U newuser1\n")])])]),a("p",[s._v("修改用户的 shell")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -s /sbin/nologin ftpuser\n")])])]),a("h2",{attrs:{id:"sudo-授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sudo-授权","aria-hidden":"true"}},[s._v("#")]),s._v(" sudo 授权")]),s._v(" "),a("p",[s._v("个人用户的权限只可以在本home下有完整权限，其他目录要看别人授权。而经常需要root用户的权限，这时候sudo可以化身为root来操作。我记得我曾经sudo创建了文件，然后发现自己并没有读写权限，因为查看权限是root创建的。")]),s._v(" "),a("p",[s._v("这是未授权之前 quanzaiyu 用户使用 sudo 命令时提示")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("quanzaiyu is not in the sudoers file.  This incident will be reported.\n")])])]),a("p",[s._v("新创建的用户并不能使用sudo命令，需要给他添加授权。")]),s._v(" "),a("p",[s._v("sudo命令的授权管理是在sudoers文件里的。可以看看sudoers：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("whereis")]),s._v(" sudoers\nsudoers: /etc/sudoers /etc/sudoers.d /usr/libexec/sudoers.so /usr/share/man/man5/sudoers.5.gz\n")])])]),a("p",[s._v("找到这个文件位置之后再查看权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l /etc/sudoers\n-r--r----- 1 root root 4251 9月  25 15:08 /etc/sudoers\n")])])]),a("p",[s._v("可以看到，只有只读的权限，如果想要修改的话，需要先添加w权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -v u+w /etc/sudoers\nmode of "),a("span",{attrs:{class:"token string"}},[s._v('"/etc/sudoers"')]),s._v(" changed from 0440 "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r--r-----"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to 0640 "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw-r-----"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("然后就可以添加内容了，在下面的一行下追加新增的用户：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ vim /etc/sudoers\n"),a("span",{attrs:{class:"token comment"}},[s._v("## Allow root to run any commands anywher")]),s._v("\nroot    ALL"),a("span",{attrs:{class:"token operator"}},[s._v("=")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\nquanzaiyu  ALL"),a("span",{attrs:{class:"token operator"}},[s._v("=")]),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL  "),a("span",{attrs:{class:"token comment"}},[s._v("# 这个是新增的用户")]),s._v("\n")])])]),a("p",[s._v("wq保存退出，这时候要记得将写权限收回：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -v u-w /etc/sudoers\nmode of "),a("span",{attrs:{class:"token string"}},[s._v('"/etc/sudoers"')]),s._v(" changed from 0640 "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw-r-----"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to 0440 "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r--r-----"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("或 "),a("code",[s._v("chmod 0440 sudoers")])]),s._v(" "),a("p",[s._v("这时候使用新用户登录，使用sudo：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/passwd\n"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{attrs:{class:"token keyword"}},[s._v("for")]),s._v(" linuxidc:\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    "),a("span",{attrs:{class:"token comment"}},[s._v("#1) Respect the privacy of others.")]),s._v("\n    "),a("span",{attrs:{class:"token comment"}},[s._v("#2) Think before you type.")]),s._v("\n    "),a("span",{attrs:{class:"token comment"}},[s._v("#3) With great power comes great responsibility.")]),s._v("\n")])])]),a("p",[s._v("第一次使用会提示你，你已经化身超人，身负责任。而且需要输入密码才可以下一步。")]),s._v(" "),a("p",[s._v("如果不想需要输入密码，将最后一个 ALL 修改成 NOPASSWD: ALL")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("quanzaiyu ALL=(ALL)     NOPASSWD:ALL\n")])])]),a("h2",{attrs:{id:"权限管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#权限管理","aria-hidden":"true"}},[s._v("#")]),s._v(" 权限管理")]),s._v(" "),a("h3",{attrs:{id:"passwd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#passwd","aria-hidden":"true"}},[s._v("#")]),s._v(" passwd")]),s._v(" "),a("p",[s._v("在 Linux 中，用户及密码文件位于 "),a("code",[s._v("/etc/passwd")]),s._v(" 中，")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("cat")]),s._v(" -n /etc/passwd\n     1\troot:x:0:0:root:/root:/bin/bash\n     2\tbin:x:1:1:bin:/bin:/sbin/nologin\n     3\tdaemon:x:2:2:daemon:/sbin:/sbin/nologin\n     4\tadm:x:3:4:adm:/var/adm:/sbin/nologin\n     5\tlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\n     6\tsync:x:5:0:sync:/sbin:/bin/sync\n     7\tshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\n     8\thalt:x:7:0:halt:/sbin:/sbin/halt\n     9\tmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\n    10\toperator:x:11:0:operator:/root:/sbin/nologin\n    11\tgames:x:12:100:games:/usr/games:/sbin/nologin\n    12\tftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\n    13\tnobody:x:99:99:Nobody:/:/sbin/nologin\n    14\tsystemd-bus-proxy:x:999:998:systemd Bus Proxy:/:/sbin/nologin\n    15\tsystemd-network:x:192:192:systemd Network Management:/:/sbin/nologin\n    16\tdbus:x:81:81:System message bus:/:/sbin/nologin\n    17\tpolkitd:x:998:997:User "),a("span",{attrs:{class:"token keyword"}},[s._v("for")]),s._v(" polkitd:/:/sbin/nologin\n    18\ttss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin\n    19\tsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\n    20\tpostfix:x:89:89::/var/spool/postfix:/sbin/nologin\n    21\tchrony:x:997:995::/var/lib/chrony:/sbin/nologin\n    22\tquanzaiyu:x:1000:1000:quanzaiyu:/home/quanzaiyu:/bin/bash\n    23\tdockerroot:x:996:993:Docker User:/var/lib/docker:/sbin/nologin\n    24\tftper:x:1001:1001::/home/ftper:/bin/bash\n    25\tnginx:x:995:991:nginx user:/var/cache/nginx:/sbin/nologin\n    26\tmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/false\n    27\tapache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin\n    28\tgit:x:1002:1002::/home/git:/usr/bin/git-shell\n")])])]),a("h3",{attrs:{id:"etc-passwd-中的字段分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#etc-passwd-中的字段分析","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("code",[s._v("/etc/passwd")]),s._v(" 中的字段分析")]),s._v(" "),a("ul",[a("li",[s._v("ACCOUNT：用户名")]),s._v(" "),a("li",[s._v("PASSWORD：密码占位符")]),s._v(" "),a("li",[s._v("UID：用户ID")]),s._v(" "),a("li",[s._v("GID：用户组ID")]),s._v(" "),a("li",[s._v("COMMAND：注释信息")]),s._v(" "),a("li",[s._v("HOME DIR：用户家目录")]),s._v(" "),a("li",[s._v("SHELL：用户的默认 shell")])]),s._v(" "),a("h3",{attrs:{id:"etc-shadow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#etc-shadow","aria-hidden":"true"}},[s._v("#")]),s._v(" "),a("code",[s._v("/etc/shadow")])]),s._v(" "),a("p",[s._v("密码占位符，其值是 x，显然这不是真正的密码。真正的密码保存在哪里呢？在 /etc/shadow 文件中，此文件中保存的也不是明文密码，而是经过加密处理之后的密码。我们来看一下 /etc/shadow 中的内容（root only）：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/shadow\n     1\troot:"),a("span",{attrs:{class:"token variable"}},[s._v("$6")]),a("span",{attrs:{class:"token variable"}},[s._v("$gV")]),s._v(".KVvRI/4wSk3fS"),a("span",{attrs:{class:"token variable"}},[s._v("$s3GXP7hk4qtqyrL1cichXmbfaJuxUd4Z")]),s._v("/dW9GsgzYOGBNZU.eKyi.IhRyukZj0coReMxYQ8eYBuzS0bUDAKs/1::0:99999:7:::\n     2\tbin:*:17110:0:99999:7:::\n     3\tdaemon:*:17110:0:99999:7:::\n     4\tadm:*:17110:0:99999:7:::\n     5\tlp:*:17110:0:99999:7:::\n     6\tsync:*:17110:0:99999:7:::\n     7\tshutdown:*:17110:0:99999:7:::\n     8\thalt:*:17110:0:99999:7:::\n     9\tmail:*:17110:0:99999:7:::\n    10\toperator:*:17110:0:99999:7:::\n    11\tgames:*:17110:0:99999:7:::\n    12\tftp:*:17110:0:99999:7:::\n    13\tnobody:*:17110:0:99999:7:::\n")])])]),a("h3",{attrs:{id:"一些常见的分组形式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些常见的分组形式","aria-hidden":"true"}},[s._v("#")]),s._v(" 一些常见的分组形式")]),s._v(" "),a("p",[s._v("对用户或者用户组分组的方式，站在不同的角度，可以进行不同的区分。")]),s._v(" "),a("p",[s._v("通过用户类型分组，我们可以把用户分为：")]),s._v(" "),a("ul",[a("li",[s._v("管理员")]),s._v(" "),a("li",[s._v("普通用户")])]),s._v(" "),a("p",[s._v("通过用户组类型分组，我们可以把用户组分为：")]),s._v(" "),a("ul",[a("li",[s._v("管理员组")]),s._v(" "),a("li",[s._v("普通用户组")])]),s._v(" "),a("p",[s._v("从用户的角度，我们可以把用户组分为：")]),s._v(" "),a("ul",[a("li",[s._v("基本组（默认组）")]),s._v(" "),a("li",[s._v("额外组（附加组）")])]),s._v(" "),a("p",[s._v("◦于普通用户，我们还可以分为:")]),s._v(" "),a("ul",[a("li",[s._v("系统用户")]),s._v(" "),a("li",[s._v("普通用户")])]),s._v(" "),a("p",[s._v("因此，对于普通用户组，我们也可以分为：")]),s._v(" "),a("ul",[a("li",[s._v("系统用户组")]),s._v(" "),a("li",[s._v("普通用户组")])]),s._v(" "),a("h3",{attrs:{id:"用户特征码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户特征码","aria-hidden":"true"}},[s._v("#")]),s._v(" 用户特征码")]),s._v(" "),a("p",[s._v("操作系统时通过用户特征码来识别用户的。对于人类，我们识别用户是通过用户名，因为用户名（字符串）好记。而计算机觉得数字更好记一些，于是在创建用户时系统会为其分配一个唯一的特征码，用以识别该用户，这个特征码也叫UID。同样的，用户组也有特征码，叫做GID。")]),s._v(" "),a("p",[s._v("Linux 系统中，UID以如下的方式划分：")]),s._v(" "),a("ul",[a("li",[s._v("0 表示管理员（root）")]),s._v(" "),a("li",[s._v("1 - 500 表示系统用户")]),s._v(" "),a("li",[s._v("501 - 65535 表示普通用户")]),s._v(" "),a("li",[s._v("不同的 Linux 发行版，这些数字可能不一样")])])])},[],!1,null,null,null);r.options.__file="User.md";t.default=r.exports}}]);