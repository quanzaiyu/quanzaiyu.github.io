(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{520:function(s,t,n){"use strict";n.r(t);var a=n(1),e=Object(a.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"连接数据库"}},[s._v("连接数据库")]),s._v(" "),s._m(0),s._v(" "),n("p",[s._v("假设有数据库 :")]),s._v(" "),n("imgLink",{attrs:{src:"shortcut/013.png/small"}}),s._v(" "),n("h2",{attrs:{id:"全局配置"}},[s._v("全局配置")]),s._v(" "),s._m(1),s._v(" "),s._m(2),s._v(" "),n("p",[s._v("测试是否连接正确，在控制器中 :")]),s._v(" "),s._m(3),s._m(4),s._v(" "),n("h2",{attrs:{id:"动态配置"}},[s._v("动态配置")]),s._v(" "),s._m(5),s._v(" "),s._m(6),n("h2",{attrs:{id:"dsn-连接"}},[s._v("DSN 连接")]),s._v(" "),n("p",[s._v("使用以下格式的连接字符串 :")]),s._v(" "),s._m(7),n("p",[s._v("进行连接。")]),s._v(" "),n("p",[s._v("如:")]),s._v(" "),s._m(8),s._m(9)],1)},[function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("Db 类是数据库操作的入口类，一定是静态调用，数据库类定义文件位于 "),t("code",[this._v("thinkphp/library/think/Db.php")]),this._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("配置好数据库连接文件 "),t("code",[this._v("database.php")]),this._v(" 后，就可在控制器中进行数据库连接。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("使用 "),t("strong",[this._v("table")]),this._v(" 语句选择数据表。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-php line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("app"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("index"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("controller")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("think"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Controller")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("think"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Db")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("Index")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("Controller")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Db"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token function"}},[s._v("table")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'user'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("where")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'id'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("1")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("value")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'name'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("访问 "),t("code",[this._v("http://www.my-tp5.com/")]),this._v(" 可以看到输出 "),t("code",[this._v("xiaoyu")]),this._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("如果没有配置 连接文件 "),t("code",[this._v("database.php")]),this._v("，或者需要一次性连接某个数据库，可以使用 动态配置。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-php line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("app"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("index"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("controller")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("think"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Controller")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("think"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Db")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("Index")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("Controller")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Db"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token function"}},[s._v("connect")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'type'")]),s._v("            "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'mysql'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'hostname'")]),s._v("        "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'127.0.0.1'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'database'")]),s._v("        "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'test'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'username'")]),s._v("        "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'root'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'password'")]),s._v("        "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'root'")]),s._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("table")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'user'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("where")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'id'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("1")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("value")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'name'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("数据库类型://用户名:密码@数据库地址:端口号/数据库名称#字符集\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-php line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-php"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("app"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("index"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("controller")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("think"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Controller")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),n("span",{attrs:{class:"token package"}},[s._v("think"),n("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Db")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("Index")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("Controller")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("index")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{attrs:{class:"token variable"}},[s._v("$dsn")]),s._v(" "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'mysql://root:root@127.0.0.1:3306/test#utf8'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),n("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Db"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token function"}},[s._v("connect")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token variable"}},[s._v("$dsn")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("table")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'user'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("where")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'id'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("2")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{attrs:{class:"token operator"}},[s._v("-")]),n("span",{attrs:{class:"token operator"}},[s._v(">")]),n("span",{attrs:{class:"token function"}},[s._v("value")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'name'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("如果输出 "),t("code",[this._v("xiaoqiao")]),this._v(" 则连接正确。")])}],!1,null,null,null);e.options.__file="Connect.md";t.default=e.exports}}]);