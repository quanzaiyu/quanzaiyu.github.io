(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{608:function(n,e,t){"use strict";t.r(e);var a=t(0),s=Object(a.a)({},function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h1",{attrs:{id:"在-docker-中部署静态网站"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-docker-中部署静态网站","aria-hidden":"true"}},[n._v("#")]),n._v(" 在 Docker 中部署静态网站")]),n._v(" "),t("h2",{attrs:{id:"在-ubuntu-容器中安装-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-ubuntu-容器中安装-nginx","aria-hidden":"true"}},[n._v("#")]),n._v(" 在 Ubuntu 容器中安装 nginx")]),n._v(" "),t("p",[n._v("首先，我们 ubuntu 镜像创建一个容器：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("[root@node1 ~]# docker run -p 80 -it --name ubuntu_docker ubuntu /bin/bash\n")])])]),t("p",[n._v("进入到此容器，安装一些必要的软件：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("root@833956bae2f8:/# apt-get update\nroot@833956bae2f8:/# apt-get install vim -y\nroot@833956bae2f8:/# apt-get install nginx -y --fix-missing\n")])])]),t("p",[n._v("创建一个存储 web 静态网站：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('root@833956bae2f8:/# mkdir -p /var/www/html\nroot@833956bae2f8:/# vim /var/www/html/index.html\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <title>Hello Docker</title>\n</head>\n<body>\n  <h1>Hello Docker</h1>\n</body>\n</html>\n')])])]),t("p",[n._v("修改nginx配置文件")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("root@833956bae2f8:/# whereis nginx\nnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx\nroot@833956bae2f8:/# ls /etc/nginx\nconf.d  fastcgi.conf  fastcgi_params  koi-utf  koi-win  mime.types  modules-available  modules-enabled  nginx.conf  proxy_params  scgi_params  sites-available  sites-enabled  snippets  uwsgi_params  win-utf\nroot@833956bae2f8:/etc/nginx/sites-enabled# ls /etc/nginx/sites-enabled\ndefault\nroot@833956bae2f8:/etc/nginx/sites-enabled# vim /etc/nginx/sites-enabled/default\n")])])]),t("p",[n._v("将 root 字段改为刚才咱们创建的 web 静态网站路径：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("server {\n  ...\n  root /var/www/html;\n  ...\n}\n")])])]),t("p",[n._v("运行 nginx，直接执行 "),t("code",[n._v("nginx")]),n._v(" 命令即可。")]),n._v(" "),t("p",[n._v("查看 nginx 服务运行情况：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("root@833956bae2f8:/# ps -ef\nUID         PID   PPID  C STIME TTY          TIME CMD\nroot          1      0  0 14:53 ?        00:00:00 /bin/bash\nroot       1022      1  0 15:17 ?        00:00:00 nginx: master process nginx\nwww-data   1023   1022  0 15:17 ?        00:00:00 nginx: worker process\nroot       1025      1  0 15:20 ?        00:00:00 ps -ef\n")])])]),t("p",[n._v("然后退出容器，使用 "),t("code",[n._v("Ctrl + P + Q")]),n._v("，返回宿主机。")]),n._v(" "),t("p",[n._v("查看容器在宿主机中的IP地址：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('[root@node1 ~]# docker inspect ubuntu_server | grep IPAddress\n    "SecondaryIPAddresses": null,\n    "IPAddress": "172.17.0.2",\n            "IPAddress": "172.17.0.2",\n')])])]),t("p",[n._v('可以看到容器在宿主机中的IP为"172.17.0.2"')]),n._v(" "),t("p",[n._v("查看容器内端口映射到宿主机的端口")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("[root@node1 ~]# docker port ubuntu_server\n80/tcp -> 0.0.0.0:49167\n")])])]),t("p",[n._v("使用 curl 测试端口是否连通：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('[root@node1 ~]# curl http://172.17.0.2\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <title>Hello Docker</title>\n</head>\n<body>\n  <h1>Hello Docker</h1>\n</body>\n</html>\n[root@node1 ~]# curl http://172.0.0.1:49167\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <title>Hello Docker</title>\n</head>\n<body>\n  <h1>Hello Docker</h1>\n</body>\n</html>\n')])])]),t("h2",{attrs:{id:"直接使用-nginx-镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#直接使用-nginx-镜像","aria-hidden":"true"}},[n._v("#")]),n._v(" 直接使用 nginx 镜像")]),n._v(" "),t("p",[n._v("更简单的做法是直接拉取nginx镜像，运行此镜像并指定映射端口即可：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('[root@node1 ~]# docker pull nginx\n[root@node1 ~]# docker run --name nginx-server -d -p 8080:80 nginx\n58d4a2614675ec421ac877cb2732d95747922481db10d5214e49669877ab4c74\n[root@node1 ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES\n58d4a2614675        nginx               "nginx -g \'daemon ..."   6 seconds ago       Up 5 seconds        0.0.0.0:8080->80/tcp   nginx-server\n')])])]),t("p",[n._v("可以看到，nginx 的 80 端口已经映射到宿主机的8080端口。")]),n._v(" "),t("p",[n._v("测试一下是否可用：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('[root@node1 ~]# curl http://127.0.0.1:8080\n<!DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!</title>\n<style>\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n</style>\n</head>\n<body>\n<h1>Welcome to nginx!</h1>\n<p>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.</p>\n\n<p>For online documentation and support please refer to\n<a href="http://nginx.org/">nginx.org</a>.<br/>\nCommercial support is available at\n<a href="http://nginx.com/">nginx.com</a>.</p>\n\n<p><em>Thank you for using nginx.</em></p>\n</body>\n</html>\n')])])]),t("p",[n._v("在宿主机里面查看容器内进程的运行情况：")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v("[root@node1 ~]# docker top nginx-server\nUID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD\nroot                7139                7124                0                   23:49               ?                   00:00:00            nginx: master process nginx -g daemon off;\n101                 7159                7139                0                   23:49               ?                   00:00:00            nginx: worker process\n[root@node1 ~]# docker port nginx-server\n80/tcp -> 0.0.0.0:8080\n")])])])])},[],!1,null,null,null);s.options.__file="StaticWeb.md";e.default=s.exports}}]);