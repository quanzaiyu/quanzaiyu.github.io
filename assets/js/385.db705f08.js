(window.webpackJsonp=window.webpackJsonp||[]).push([[385],{600:function(t,a,s){"use strict";s.r(a);var n={props:["slot-key"],mounted(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},e=s(0),o=Object(e.a)(n,function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[s("h1",{attrs:{id:"静态代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#静态代理","aria-hidden":"true"}},[t._v("#")]),t._v(" 静态代理")]),t._v(" "),s("p",[t._v("在 tp5.1，引入了 Facade 类，又叫门面类，如果想静态访问一个类中的动态方法，可以给这个类套一层静态马甲，实现静态访问，核心文件位于 "),s("code",[t._v("thinkphp/library/think/Facade.php")]),t._v(" 。")]),t._v(" "),s("p",[t._v("系统的 "),s("code",[t._v("facade")]),t._v(" 类位于 "),s("code",[t._v("thinkphp/library/think/facade")]),t._v(" 中，系统封装的 facade 位于 "),s("code",[t._v("thinkphp/base.php")]),t._v(" 文件中。")]),t._v(" "),s("p",[t._v("如果想静态调用一个动态方法，需要给当前的类绑定一个静态代理类。")]),t._v(" "),s("p",[t._v("例子同依赖注入中的Demo类，修改 Demo 类  :")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{attrs:{class:"token package"}},[t._v("app"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("common")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Demo")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" sayHello "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token variable"}},[t._v("$name")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'qzy'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'Hello '")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{attrs:{class:"token variable"}},[t._v("$name")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("创建一个 facade 管理目录 "),s("code",[t._v("application/facade")]),t._v(" ，新建一个文件 "),s("code",[t._v("Demo.php")]),t._v(" :")]),t._v(" "),s("p",[s("code",[t._v("application/facade/Demo.php")])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),s("span",{attrs:{class:"token package"}},[t._v("app"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("facade")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Demo")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("think"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Facade")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("getFacadeClass")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'app\\common\\Demo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这个文件中，继承了 Facade 类，通过重写父类方法 getFacadeClass() 进行代理，返回的是需要代理的类名。")]),t._v(" "),s("p",[t._v("在 index 控制器中加入方法 :")]),t._v(" "),s("p",[s("code",[t._v("application/index/Index.php")])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" getMethodAsStatic "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" \\"),s("span",{attrs:{class:"token package"}},[t._v("app"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("facade"),s("span",{attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Demo")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{attrs:{class:"token function"}},[t._v("sayHello")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token single-quoted-string string"}},[t._v("'xiaoyu'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("此时，访问 "),s("code",[t._v("http://www.my-tp5.com/index.php/index/index/getMethodAsStatic")]),t._v(" 可以看到结果。")])])},[],!1,null,null,null);o.options.__file="README.md";a.default=o.exports}}]);