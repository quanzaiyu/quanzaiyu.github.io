(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{526:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[s._m(0),s._v(" "),s._m(1),s._v(" "),s._m(2),s._v(" "),s._m(3),a("p",[s._v("使用 ssh 连接到指定虚拟主机，如果没有秘钥，则或提示输入密码：")]),s._v(" "),s._m(4),s._m(5),s._v(" "),s._m(6),s._v(" "),s._m(7),s._m(8),s._v(" "),s._m(9),s._v(" "),a("p",[s._v("生成 key 后，可以直接将公钥复制到服务器，也可使用命令提交到服务器")]),s._v(" "),s._m(10),s._v(" "),s._m(11),s._v(" "),s._m(12),a("p",[s._v("再次登录，不需要输入密码：")]),s._v(" "),s._m(13),s._m(14),s._v(" "),s._m(15),s._v(" "),s._m(16),s._v(" "),s._m(17),s._v(" "),s._m(18),s._m(19),s._v(" "),s._m(20),s._v(" "),s._m(21),a("p",[s._v("重启 ssh 服务即可")]),s._v(" "),s._m(22),a("p",[s._v("此时，就可以在客户端使用私钥进行 SSH 登录")]),s._v(" "),a("imgLink",{attrs:{src:"articles/009.jpg/small"}})],1)},[function(){var s=this.$createElement,t=this._self._c||s;return t("h1",{attrs:{id:"使用-ssh-登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-ssh-登录","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用 SSH 登录")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"配置虚拟主机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置虚拟主机","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置虚拟主机")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("先修改 hosts 文件，位于 "),t("code",[this._v("/etc/hosts")]),this._v("，比如")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ vim /etc/hosts\n192.168.0.15 node1\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br"),t("span",{staticClass:"line-number"},[this._v("2")]),t("br")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("ssh")]),s._v(" node1\nThe authenticity of host "),a("span",{attrs:{class:"token string"}},[s._v("'node1 (192.168.42.130)'")]),s._v(" can"),a("span",{attrs:{class:"token string"}},[s._v("'t be established.\nECDSA key fingerprint is SHA256:ahhG7mkVk4N5uuIkeXBHoqM6i5i54DRvAeCCf2RJxcM.\nECDSA key fingerprint is MD5:a5:fc:3f:43:70:ec:03:ca:5b:b1:f3:99:01:b9:8c:86.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '")]),s._v("node1,192.168.42.130"),a("span",{attrs:{class:"token string"}},[s._v("' (ECDSA) to the list of known hosts.\nroot@node1'")]),s._v("s password: \nPermission denied, please try again.\nroot@node1"),a("span",{attrs:{class:"token string"}},[s._v("'s password: \nPermission denied, please try again.\nroot@node1'")]),s._v("s password: \nPermission denied "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("publickey,gssapi-keyex,gssapi-with-mic,password"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"客户端配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#客户端配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 客户端配置")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("在客户端使用 "),t("code",[this._v("ssh-keygen -t rsa")]),this._v(" 生成秘钥")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ ssh-keygen\nGenerating public/private rsa key pair.\nEnter "),a("span",{attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("which")]),s._v(" to save the key "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/root/.ssh/id_rsa"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": \nEnter passphrase "),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empty "),a("span",{attrs:{class:"token keyword"}},[s._v("for")]),s._v(" no passphrase"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": \nEnter same passphrase again: \nYour identification has been saved "),a("span",{attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.ssh/id_rsa.\nYour public key has been saved "),a("span",{attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:oGHYvzpaHaFCSxghVKQ5GR6WbZmzm24jMVSOwfMjSmo root@node1\nThe key's randomart image is:\n+---"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("RSA 2048"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("----+\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("**"),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v("oo            "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("+B*X             "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(".*% * o          "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" B.B "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" o         "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),a("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" + * o S        "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("oE + "),a("span",{attrs:{class:"token keyword"}},[s._v(".")]),s._v(" o         "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),a("span",{attrs:{class:"token keyword"}},[s._v(".")]),s._v(" + "),a("span",{attrs:{class:"token keyword"}},[s._v(".")]),s._v(" o          "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{attrs:{class:"token keyword"}},[s._v(".")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v("=")]),a("span",{attrs:{class:"token punctuation"}},[s._v("..")]),s._v("           "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("  +.o.           "),a("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----"),a("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SHA256"),a("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-----+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("或使用命令 "),t("code",[this._v('ssh-keygen -t rsa -C "你的email地址"')]),this._v(" ，会在 "),t("code",[this._v("~/.ssh/id_rsa.pub")]),this._v(" 生成SSH公钥。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"服务器端配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务器端配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 服务器端配置")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h4",{attrs:{id:"使用命令提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用命令提交","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用命令提交")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("使用 "),t("code",[this._v("ssh-copy-id")]),this._v(" 命令将生成好的秘钥推给服务器，输入一次密码即可：")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ ssh-copy-id node1\n/usr/bin/ssh-copy-id: INFO: Source of key"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to be installed: "),a("span",{attrs:{class:"token string"}},[s._v('"/root/.ssh/id_rsa.pub"')]),s._v("\n/usr/bin/ssh-copy-id: INFO: attempting to log "),a("span",{attrs:{class:"token keyword"}},[s._v("in")]),s._v(" with the new key"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" remain to be installed -- "),a("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" you are prompted now it is to "),a("span",{attrs:{class:"token function"}},[s._v("install")]),s._v(" the new keys\nroot@node1"),a("span",{attrs:{class:"token string"}},[s._v("'s password: \n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   \"ssh '")]),s._v("node1'\"\nand check to "),a("span",{attrs:{class:"token function"}},[s._v("make")]),s._v(" sure that only the key"),a("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" you wanted were added.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{attrs:{class:"token function"}},[s._v("ssh")]),s._v(" node1\nLast failed login: Wed Oct 24 21:38:38 CST 2018 from node1 on ssh:notty\nThere were 5 failed login attempts since the last successful login.\nLast login: Wed Oct 24 20:18:50 2018 from 192.168.42.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h4",{attrs:{id:"文件内容复制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件内容复制","aria-hidden":"true"}},[this._v("#")]),this._v(" 文件内容复制")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("在Windows下，没有 "),t("code",[this._v("ssh-copy-id")]),this._v(" 命令，则可以使用文件复制的方式提交到服务器。")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("p",[s._v("将 "),a("code",[s._v("id_rsa.pub")]),s._v(" 文件里面的内容复制，保存到服务器端需要登录的用户根目录下 "),a("code",[s._v(".ssh/authorized_keys")]),s._v(" 文件中，比如 "),a("code",[s._v("/root/.ssh/authorized_keys")]),s._v("、"),a("code",[s._v("/home/user/.ssh/authorized_keys")]),s._v(" 即可。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("修改 "),t("code",[this._v("/etc/ssh/sshd_config")]),this._v("，开启 RSA 和 公钥认证")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("RSAAuthentication yes\nPubkeyAuthentication yes\nAuthorizedKeysFile      .ssh/authorized_keys\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br"),t("span",{staticClass:"line-number"},[this._v("2")]),t("br"),t("span",{staticClass:"line-number"},[this._v("3")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"关闭密码验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关闭密码验证","aria-hidden":"true"}},[this._v("#")]),this._v(" 关闭密码验证")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("为了安全起见，关闭密码认证，修改 "),t("code",[this._v("/etc/ssh/sshd_config")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("PasswordAuthentication no\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ systemctl restart sshd\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])}],!1,null,null,null);e.options.__file="SSH.md";t.default=e.exports}}]);