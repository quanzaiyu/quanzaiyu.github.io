(window.webpackJsonp=window.webpackJsonp||[]).push([[441],{756:function(s,t,n){"use strict";n.r(t);var a=n(1),e=Object(a.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"service-worker-集成"}},[s._v("Service Worker 集成")]),s._v(" "),n("p",[s._v("在不同的项目中，Service Worker 有不同的集成方式。甚至可以用插件实现。")]),s._v(" "),n("h2",{attrs:{id:"spa-注册-service-worker"}},[s._v("SPA 注册 Service Worker")]),s._v(" "),n("p",[s._v("SPA（Single Page Applications），单页 Web 应用，在工程架构上只有一个 index.html 的入口，站点的内容都是异步请求数据之后在前端渲染的，应用中的页面切换都是在前端路由控制的。")]),s._v(" "),n("p",[s._v("通常会将这个 index.html 部署到 https://yourhost，对于 SPA 的 Service Worker，只会在 index.html 中注册一次，所以我们会将 sw.js 直接放在站点的根目录保证可访问，Service Worker 的 scope 通常就是 /，这样能够控制整个 SPA 的缓存。")]),s._v(" "),n("p",[s._v("SPA 每次路由的切换都是前端渲染的过程，本质上还是在 index.html 上的前端交互，通常 Service Worker 会缓存 SPA 中的 AppShell 所需的静态资源和 index.html。当然有一种情况比较特殊，当用户从 /a 页面切换到 /b 页面，然后这时候刷新页面，此时首先渲染的还是 index.html，在执行 SPA 的路由逻辑之后，通过 SPA 前端路由的处理继续在前端渲染相应的路由对应的 Component。")]),s._v(" "),n("h2",{attrs:{id:"mpa-注册-service-worker"}},[s._v("MPA 注册 Service Worker")]),s._v(" "),n("p",[s._v("MPA（Multi Page Applications），多页应用，这种架构的模式在现如今的大型站点非常常见，例如 "),n("a",{attrs:{href:"https://h5.ele.me/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ele.me"),n("OutboundLink")],1),s._v(" 就是采用这种模式来架构的站点，这种站点有常规的 Web App 的特性，但是相比较 SPA 能够承受更重的业务体量，并且利于大型站点的后期维护和扩展。针对 MPA 的 PWA 可以阅读 "),n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/27853228",target:"_blank",rel:"noopener noreferrer"}},[s._v("饿了么的 PWA 升级实践"),n("OutboundLink")],1),s._v(" 进行更加深入了解。")]),s._v(" "),n("p",[s._v("在这里我们可以更加深入的了解一下 MPA PWA 是如何注册 sw.js 的，MPA 可以理解为是有多个 html 文件对应着多个不同的服务端路由，也就是说 https://yourhost/a 映射到 a.html, https://yourhost/b 映射到 b.html 等等。")]),s._v(" "),n("p",[s._v("那么这种架构下怎么去注册 Service Worker 呢？是不同的页面注册不同的 Service Worker，还是所有的页面都注册同一个 Service Worker？结论是：需要根据实际情况来定。")]),s._v(" "),n("h2",{attrs:{id:"在-vue-js-中集成"}},[s._v("在 Vue.js 中集成")]),s._v(" "),n("p",[s._v("这里假设项目是使用 vue-cli 创建的，模板为 webpack，要集成 service worker。")]),s._v(" "),s._m(0),s._v(" "),s._m(1),s._v(" "),n("p",[s._v("因此，我们得想一个办法，让 service worker 监听到站点下所有路径的 fetch 事件。")]),s._v(" "),s._m(2),s._v(" "),n("p",[s._v("首先，安装 copy-webpack-plugin")]),s._v(" "),s._m(3),s._m(4),s._v(" "),s._m(5),n("p",[s._v("这样，就可以放心地将 sw.js 存于站点根目录了，webpack 会将此文件复制到 dist 目录下，进行正常的 service worker 注册。")]),s._v(" "),n("p",[s._v("参考："),n("a",{attrs:{href:"https://webpack.js.org/plugins/copy-webpack-plugin/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://webpack.js.org/plugins/copy-webpack-plugin/"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("index.html")]),s._v(" "),s._m(6),n("p",[s._v("sw.js")]),s._v(" "),s._m(7),n("p",[s._v("同样的，要加入 manifest.json 也如法炮制：")]),s._v(" "),s._m(8),n("p",[s._v("index.html 引入即可")]),s._v(" "),s._m(9),n("h2",{attrs:{id:"在-vuepress-中集成"}},[s._v("在 Vuepress 中集成")]),s._v(" "),n("p",[s._v("在 Vuepress 中集成 PWA 就简单了，在 0.10 版本之后，可以直接在 config.js 配置文件中添加：")]),s._v(" "),s._m(10),s._m(11),s._v(" "),n("h2",{attrs:{id:"sw-register-webpack-plugin"}},[s._v("sw-register-webpack-plugin")]),s._v(" "),n("p",[s._v("无论是 Service Worker 作用域问题，还是 Service Worker 的更新问题，都与 Service Worker 的注册息息相关，一个看似简单的 Service Worker 的注册还是有很多地方需要注意，但是如果这些都需要在每个项目中都要自己完全实现一遍，还是非常繁琐的。而 "),n("a",{attrs:{href:"https://github.com/lavas-project/sw-register-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[s._v("sw-register-webpack-plugin"),n("OutboundLink")],1),s._v(" 作为一个 Webpack Plugin 很好的帮助我们解决了 优雅的注册 Service Worker 的问题")]),s._v(" "),s._m(12),s._v(" "),n("p",[s._v("基于以上的考虑，都可以尝试一下 sw-register-webpack-plugin")]),s._v(" "),n("p",[s._v("安装")]),s._v(" "),s._m(13),n("p",[s._v("配置 Webpack")]),s._v(" "),s._m(14)])},[function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("假设要注册的 service worker 文件名为 "),t("code",[this._v("sw.js")]),this._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("首先，我们知道，如果将文件直接放到根目录下，在地址中输入 "),t("code",[this._v("localhost/sw.js")]),this._v(" 是访问不不到的，如果将 sw.js 放到 /static 目录下，倒是可以通过 "),t("code",[this._v("localhost/static/sw.js")]),this._v(" 进行访问，但是，这样的话，service worker 只能收到 /static 路径下的 fetch 事件（例如： /static/page1/, /static/page2/）。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("我们借助 "),t("code",[this._v("copy-webpack-plugin")]),this._v(" 插件即可完成这个工作。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("yarn add copy-webpack-plugin\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("然后，改动 "),t("code",[this._v("build/webpack.base.conf.js")]),this._v(" 文件：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" CopyWebpackPlugin "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("require")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'copy-webpack-plugin'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[s._v("const")]),s._v(" originalConfig "),n("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  plugins"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("CopyWebpackPlugin")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("from")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" path"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("resolve")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'../sw.js'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        to"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" config"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("build"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("assetsRoot"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        ignore"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{attrs:{class:"token string"}},[s._v("'.*'")]),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("script")]),n("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),n("span",{attrs:{class:"token script language-javascript"}},[s._v("\n  "),n("span",{attrs:{class:"token comment"}},[s._v("// 测试 service worker")]),s._v("\n  "),n("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'serviceWorker'")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("in")]),s._v(" navigator"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    navigator"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serviceWorker"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("register")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'/sw.js'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("then")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token keyword"}},[s._v("function")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("registration"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{attrs:{class:"token comment"}},[s._v("// Registration was successful")]),s._v("\n      console"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("log")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'ServiceWorker registration successful with scope: '")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    registration"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scope"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token keyword"}},[s._v("catch")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token keyword"}},[s._v("function")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{attrs:{class:"token comment"}},[s._v("// registration failed :(")]),s._v("\n      console"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("log")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'ServiceWorker registration failed: '")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")]),n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("script")]),n("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("/* eslint-disable */")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("// Set the callback for the install step")]),s._v("\nself"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("addEventListener")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v("'install'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token keyword"}},[s._v("function")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{attrs:{class:"token comment"}},[s._v("// Perform install steps")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("CopyWebpackPlugin")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("from")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" path"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("resolve")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'../sw.js'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        to"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" config"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("build"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("assetsRoot\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{attrs:{class:"token keyword"}},[s._v("from")]),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" path"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("resolve")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'../manifest.json'")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        to"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" config"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("build"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("assetsRoot\n      "),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token tag"}},[n("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("link")]),s._v(" "),n("span",{attrs:{class:"token attr-name"}},[s._v("rel")]),n("span",{attrs:{class:"token attr-value"}},[n("span",{attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{attrs:{class:"token punctuation"}},[s._v('"')]),s._v("manifest"),n("span",{attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),n("span",{attrs:{class:"token attr-name"}},[s._v("href")]),n("span",{attrs:{class:"token attr-value"}},[n("span",{attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{attrs:{class:"token punctuation"}},[s._v('"')]),s._v("/manifest.json"),n("span",{attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[this._v("serviceWorker"),t("span",{attrs:{class:"token punctuation"}},[this._v(":")]),this._v(" "),t("span",{attrs:{class:"token boolean"}},[this._v("true")]),this._v("\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("Vuepress 会自动生成并注册 service worker，用户只需要在 .vuepress/public 中添加 "),t("code",[this._v("manifest.json")]),this._v(" 即可。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("如果项目是基于 Webpack 开发的")]),this._v(" "),t("li",[this._v("如果不希望自己考虑繁琐的 Service Worker 问题")]),this._v(" "),t("li",[this._v("无论是 SPA 还是 MPA")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("yarn add sw-register-webpack-plugin\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("import")]),s._v(" SwRegisterWebpackPlugin "),n("span",{attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v("'sw-register-webpack-plugin'")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n\n"),n("span",{attrs:{class:"token function"}},[s._v("webpack")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  plugins"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{attrs:{class:"token class-name"}},[s._v("SwReginsterWebpackPlugin")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token comment"}},[s._v("/* options */")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])])}],!1,null,null,null);t.default=e.exports}}]);