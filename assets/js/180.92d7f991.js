(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{512:function(s,e,t){"use strict";t.r(e);var a={props:["slot-key"],mounted(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},o=t(0),r=Object(o.a)(a,function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.slotKey}},[t("h1",{attrs:{id:"配置-ssh-秘钥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-ssh-秘钥","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置 SSH 秘钥")]),s._v(" "),t("p",[s._v("在客户端使用 "),t("code",[s._v("ssh-keygen -t rsa")]),s._v(" 生成秘钥")]),s._v(" "),t("p",[s._v("或使用命令 "),t("code",[s._v('ssh-keygen -t rsa -C "你的email地址"')]),s._v(" ，会在 "),t("code",[s._v("~/.ssh/id_rsa.pub")]),s._v(" 生成SSH公钥。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@localhost learngit.git]# ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/root/.ssh/id_rsa): \nCreated directory '/root/.ssh'.\nEnter passphrase (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in /root/.ssh/id_rsa.\nYour public key has been saved in /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:cNjycjEgK1if5rGzEKMQkKrAdQxWWy+strrsX3gQ4sA root@localhost\nThe key's randomart image is:\n+---[RSA 2048]----+\n|+..o=...         |\n|o+.o *++.        |\n|=E=.Bo+o=.       |\n|+oo*.oo=.o       |\n|+ ..++. S        |\n|.  ..o+o         |\n|    .o o         |\n|  . . o          |\n|  .=o.           |\n+----[SHA256]-----+\n")])])]),t("p",[s._v("可以看到，root 用户生成的秘钥位于 "),t("code",[s._v("/root/.ssh")]),s._v(" 下，其他用户生成的秘钥位于 "),t("code",[s._v("/home/user/.ssh")]),s._v(" 下")]),s._v(" "),t("h2",{attrs:{id:"生成-authorized-keys"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成-authorized-keys","aria-hidden":"true"}},[s._v("#")]),s._v(" 生成 authorized_keys")]),s._v(" "),t("p",[t("code",[s._v("authorized_keys")]),s._v(" 文件用于存储信任的客户端公钥，将受信任的公钥 "),t("code",[s._v("id_rsa.pub")]),s._v(" 写入即可")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@localhost .ssh]# cat id_rsa.pub >> authorized_keys\n")])])]),t("p",[s._v("将其他机器上的 ssh 公钥加入服务器列表")]),s._v(" "),t("p",[s._v("比如 Windows 系统中的公钥，位于 "),t("code",[s._v("C:\\Users\\Administrator\\.ssh\\id_rsa.pub")]),s._v(" 中，打开此文件将内容添加至用户目录 .ssh 目录下的 "),t("code",[s._v("authorized_keys")]),s._v(" 文件中即可，比如 "),t("code",[s._v("/home/git/.ssh/authorized_keys")])]),s._v(" "),t("p",[s._v("修改 sshd 配置文件 "),t("code",[s._v("vim /etc/ssh/sshd_config")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("RSAAuthentication yes\nPubkeyAuthentication yes\nAuthorizedKeysFile      .ssh/authorized_keys\n")])])]),t("p",[s._v("重启 ssh 服务即可")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("systemctl restart sshd\n")])])]),t("p",[s._v("此时 clone 就不需要再输入密码了。")]),s._v(" "),t("h2",{attrs:{id:"注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意事项","aria-hidden":"true"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),t("p",[s._v("现在客户端可以通过 git clone 命令克隆远程仓库了，注意这里有些问题需要注意，SSH对公钥，私钥的权限和所有权的要求是非常严格的，总结如下：")]),s._v(" "),t("ol",[t("li",[s._v("下面两个目录的所有权必须是git（上面创建的git用户），所属组也应该是git，权限必须为700")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("chmod 700 /home/git")])]),s._v(" "),t("li",[t("code",[s._v("chmod 700 /home/git/.ssh")])])]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("公钥文件的所有权必须是git，所属组也必须是git，权限必须是644")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("chmod 644 /home/git/.ssh/authorized_keys")])])]),s._v(" "),t("p",[s._v("如果权限不对，会造成不能正常登录，报错信息：Permission denied (publickey,gssapi-with-mic.....)")])])},[],!1,null,null,null);r.options.__file="SSH.md";e.default=r.exports}}]);