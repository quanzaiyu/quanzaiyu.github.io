(window.webpackJsonp=window.webpackJsonp||[]).push([[504],{722:function(t,e,a){"use strict";a.r(e);var r=a(1),s=Object(r.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"前端请求的演化及应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端请求的演化及应用","aria-hidden":"true"}},[t._v("#")]),t._v(" 前端请求的演化及应用")]),t._v(" "),a("h2",{attrs:{id:"xmlhttprequest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest","aria-hidden":"true"}},[t._v("#")]),t._v(" XMLHTTPRequest")]),t._v(" "),a("h3",{attrs:{id:"jquery"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jquery","aria-hidden":"true"}},[t._v("#")]),t._v(" JQuery")]),t._v(" "),a("h3",{attrs:{id:"axios"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#axios","aria-hidden":"true"}},[t._v("#")]),t._v(" Axios")]),t._v(" "),a("h3",{attrs:{id:"手动封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动封装","aria-hidden":"true"}},[t._v("#")]),t._v(" 手动封装")]),t._v(" "),a("h2",{attrs:{id:"fetch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fetch","aria-hidden":"true"}},[t._v("#")]),t._v(" Fetch")]),t._v(" "),a("h3",{attrs:{id:"手动封装-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动封装-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 手动封装")]),t._v(" "),a("h2",{attrs:{id:"contenttype"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contenttype","aria-hidden":"true"}},[t._v("#")]),t._v(" ContentType")]),t._v(" "),a("h3",{attrs:{id:"x-www-urlencoded"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#x-www-urlencoded","aria-hidden":"true"}},[t._v("#")]),t._v(" x-www-urlencoded")]),t._v(" "),a("h3",{attrs:{id:"form-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#form-data","aria-hidden":"true"}},[t._v("#")]),t._v(" form-data")]),t._v(" "),a("h3",{attrs:{id:"json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json","aria-hidden":"true"}},[t._v("#")]),t._v(" json")]),t._v(" "),a("h2",{attrs:{id:"跨域解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跨域解决方案","aria-hidden":"true"}},[t._v("#")]),t._v(" 跨域解决方案")]),t._v(" "),a("h3",{attrs:{id:"cors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cors","aria-hidden":"true"}},[t._v("#")]),t._v(" CORS")]),t._v(" "),a("h3",{attrs:{id:"jsonp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsonp","aria-hidden":"true"}},[t._v("#")]),t._v(" jsonp")]),t._v(" "),a("h3",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),a("h2",{attrs:{id:"简单请求与复杂请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单请求与复杂请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 简单请求与复杂请求")]),t._v(" "),a("p",[t._v("CORS可以分成两种：")]),t._v(" "),a("p",[t._v("1、"),a("strong",[t._v("简单请求")]),t._v("\n2、"),a("strong",[t._v("复杂请求")])]),t._v(" "),a("h3",{attrs:{id:"简单请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 简单请求")]),t._v(" "),a("p",[t._v("一个简单的请求大致如下：")]),t._v(" "),a("p",[t._v("HTTP方法是下列之一")]),t._v(" "),a("ul",[a("li",[t._v("HEAD")]),t._v(" "),a("li",[t._v("GET")]),t._v(" "),a("li",[t._v("POST")])]),t._v(" "),a("p",[t._v("HTTP头信息不超出以下几种字段")]),t._v(" "),a("ul",[a("li",[t._v("Accept")]),t._v(" "),a("li",[t._v("Accept-Language")]),t._v(" "),a("li",[t._v("Content-Language")]),t._v(" "),a("li",[t._v("Last-Event-ID")]),t._v(" "),a("li",[t._v("Content-Type 只能是下列之一\n"),a("ul",[a("li",[t._v("application/x-www-form-urlencoded")]),t._v(" "),a("li",[t._v("multipart/form-data")]),t._v(" "),a("li",[t._v("text/plain")])])])]),t._v(" "),a("p",[t._v("任何一个不满足上述要求的请求，即被认为是复杂请求。一个复杂请求不仅有包含通信内容的请求，同时也包含预请求（preflight request）。")]),t._v(" "),a("p",[a("strong",[t._v("简单请求")]),t._v("的发送从代码上来看和普通的XHR没太大区别，但是HTTP头当中要求总是包含一个域（Origin）的信息。该域包含协议名、地址以及一个可选的端口。不过这一项实际上由浏览器代为发送，并不是开发者代码可以触及到的。")]),t._v(" "),a("p",[t._v("简单请求的部分响应头及解释如下：")]),t._v(" "),a("ul",[a("li",[t._v('Access-Control-Allow-Origin（必含）- 不可省略，否则请求按失败处理。该项控制数据的可见范围，如果希望数据对任何人都可见，可以填写"*"。')]),t._v(" "),a("li",[t._v("Access-Control-Allow-Credentials（可选） – 该项标志着请求当中是否包含cookies信息，只有一个可选值：true（必为小写）。如果不包含cookies，请略去该项，而不是填写false。这一项与XmlHttpRequest2对象当中的withCredentials属性应保持一致，即withCredentials为true时该项也为true；withCredentials为false时，省略该项不写。反之则导致请求失败。")]),t._v(" "),a("li",[t._v("Access-Control-Expose-Headers（可选） – 该项确定XmlHttpRequest2对象当中getResponseHeader()方法所能获得的额外信息。通常情况下，getResponseHeader()方法只能获得如下的信息：")]),t._v(" "),a("li",[t._v("Cache-Control")]),t._v(" "),a("li",[t._v("Content-Language")]),t._v(" "),a("li",[t._v("Content-Type")]),t._v(" "),a("li",[t._v("Expires")]),t._v(" "),a("li",[t._v("Last-Modified")]),t._v(" "),a("li",[t._v("Pragma 当你需要访问额外的信息时，就需要在这一项当中填写并以逗号进行分隔")])]),t._v(" "),a("p",[t._v("如果仅仅是简单请求，那么即便不用CORS也没有什么大不了，但CORS的复杂请求就令CORS显得更加有用了。简单来说，任何不满足上述简单请求要求的请求，都属于复杂请求。比如说你需要发送PUT、DELETE等HTTP动作，或者发送Content-Type: application/json的内容。")]),t._v(" "),a("h3",{attrs:{id:"复杂请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复杂请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 复杂请求")]),t._v(" "),a("p",[a("strong",[t._v("复杂请求")]),t._v('表面上看起来和简单请求使用上差不多，但实际上浏览器发送了不止一个请求。其中最先发送的是一种"预请求"，此时作为服务端，也需要返回"预回应"作为响应。预请求实际上是对服务端的一种权限请求，只有当预请求成功返回，实际请求才开始执行。')]),t._v(" "),a("p",[t._v("预请求以OPTIONS形式发送，当中同样包含域，并且还包含了两项CORS特有的内容：")]),t._v(" "),a("ul",[a("li",[t._v("Access-Control-Request-Method – 该项内容是实际请求的种类，可以是GET、POST之类的简单请求，也可以是PUT、DELETE等等。")]),t._v(" "),a("li",[t._v("Access-Control-Request-Headers – 该项是一个以逗号分隔的列表，当中是复杂请求所使用的头部。")])]),t._v(" "),a("p",[t._v("显而易见，这个预请求实际上就是在为之后的实际请求发送一个权限请求，在预回应返回的内容当中，服务端应当对这两项进行回复，以让浏览器确定请求是否能够成功完成。")]),t._v(" "),a("p",[t._v("复杂请求的部分响应头及解释如下：")]),t._v(" "),a("ul",[a("li",[t._v("Access-Control-Allow-Origin（必含） – 和简单请求一样的，必须包含一个域。")]),t._v(" "),a("li",[t._v("Access-Control-Allow-Methods（必含） – 这是对预请求当中Access-Control-Request-Method的回复，这一回复将是一个以逗号分隔的列表。尽管客户端或许只请求某一方法，但服务端仍然可以返回所有允许的方法，以便客户端将其缓存。")]),t._v(" "),a("li",[t._v("Access-Control-Allow-Headers（当预请求中包含Access-Control-Request-Headers时必须包含） – 这是对预请求当中Access-Control-Request-Headers的回复，和上面一样是以逗号分隔的列表，可以返回所有支持的头部。这里在实际使用中有遇到，所有支持的头部一时可能不能完全写出来，而又不想在这一层做过多的判断，没关系，事实上通过request的header可以直接取到Access-Control-Request-Headers，直接把对应的value设置到Access-Control-Allow-Headers即可。")]),t._v(" "),a("li",[t._v("Access-Control-Allow-Credentials（可选） – 和简单请求当中作用相同。")]),t._v(" "),a("li",[t._v("Access-Control-Max-Age（可选） – 以秒为单位的缓存时间。预请求的的发送并非免费午餐，允许时应当尽可能缓存。")])]),t._v(" "),a("p",[t._v("一旦预回应如期而至，所请求的权限也都已满足，则实际请求开始发送。")]),t._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.poorren.com/cross-origin-resource-sharing-simple-complex",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS跨域请求[简单请求与复杂请求]"),a("OutboundLink")],1)])])])},[],!1,null,null,null);e.default=s.exports}}]);