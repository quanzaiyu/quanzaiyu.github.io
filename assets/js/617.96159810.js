(window.webpackJsonp=window.webpackJsonp||[]).push([[617],{421:function(s,a,t){"use strict";t.r(a);var n={props:["slot-key"]},e=t(0),r=Object(e.a)(n,function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.slotKey}},[t("h1",{attrs:{id:"mac-os-设置定时任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mac-os-设置定时任务","aria-hidden":"true"}},[s._v("#")]),s._v(" Mac OS 设置定时任务")]),s._v(" "),t("h2",{attrs:{id:"使用-launchctl-设置定时任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-launchctl-设置定时任务","aria-hidden":"true"}},[s._v("#")]),s._v(" 使用 launchctl 设置定时任务")]),s._v(" "),t("ul",[t("li",[s._v("launchctl 是一个统一的服务管理框架，可以启动、停止和管理守护进程、应用程序、进程和脚本等。")]),s._v(" "),t("li",[s._v("launchctl 是通过配置文件来指定执行周期和任务的。")])]),s._v(" "),t("p",[s._v("当然 mac 也可以像 linux 系统一样，使用 crontab 命令来添加定时任务，这里就不赘述，具体可参见："),t("a",{attrs:{href:"http://codingpub.github.io/2016/10/27/OS-X-%E6%B7%BB%E5%8A%A0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/",target:"_blank",rel:"noopener noreferrer"}},[s._v("OS X 添加定时任务"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("下面将手把手教你在mac上创建定时任务。（任务目标：每天晚上十点定时执行 "),t("code",[s._v("/Users/demo/helloworld.py")]),s._v(" 的 python 程序）")]),s._v(" "),t("h3",{attrs:{id:"创建-run-sh-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建-run-sh-脚本","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建 run.sh 脚本")]),s._v(" "),t("p",[s._v("进入 "),t("code",[s._v("helloworld.py")]),s._v(" 程序所在目录")]),s._v(" "),t("p",[t("code",[s._v("cd /User/demo")])]),s._v(" "),t("p",[s._v("创建run.sh脚本")]),s._v(" "),t("p",[t("code",[s._v("vi run.sh")])]),s._v(" "),t("p",[s._v("添加执行 "),t("code",[s._v("helloworld.py")]),s._v(" 的命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 记录一下开始时间")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),t("span",{attrs:{class:"token variable"}},[t("span",{attrs:{class:"token variable"}},[s._v("`")]),t("span",{attrs:{class:"token function"}},[s._v("date")]),t("span",{attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /Users/demo/log "),t("span",{attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 进入helloworld.py程序所在目录")]),s._v("\n"),t("span",{attrs:{class:"token function"}},[s._v("cd")]),s._v(" /Users/demo "),t("span",{attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 执行python脚本（注意前面要指定python运行环境/usr/bin/python，根据自己的情况改变）")]),s._v("\n/usr/bin/python helloworld.py\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 运行完成")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'finish'")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /Users/demo/log\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("code",[s._v("：wq")]),s._v(" 保存退出")]),s._v(" "),t("p",[s._v("注意，脚本要改成可执行的权限 "),t("code",[s._v("chmod 777 run.sh")])]),s._v(" "),t("h3",{attrs:{id:"编写-plist-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编写-plist-文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 编写 plist 文件")]),s._v(" "),t("p",[s._v("launchctl 将根据plist文件的信息来启动任务。")]),s._v(" "),t("p",[s._v("plist脚本一般存放在以下目录：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("/Library/LaunchDaemons "),t("span",{attrs:{class:"token comment"}},[s._v("# 由管理员定义的守护进程任务项，只要系统启动了，哪怕用户不登陆系统也会被执行")]),s._v("\n/Library/LaunchAgents "),t("span",{attrs:{class:"token comment"}},[s._v("# 由管理员为用户定义的任务项，当用户登陆系统后才会被执行")]),s._v("\n~/Library/LaunchDaemons "),t("span",{attrs:{class:"token comment"}},[s._v("# 由用户自己定义的守护进程任务项")]),s._v("\n~/Library/LaunchAgents "),t("span",{attrs:{class:"token comment"}},[s._v("# 由用户自己定义的任务项")]),s._v("\n/System/Library/LaunchAgents "),t("span",{attrs:{class:"token comment"}},[s._v("# 由Mac OS X为用户定义的任务项")]),s._v("\n/System/Library/LaunchDaemons "),t("span",{attrs:{class:"token comment"}},[s._v("# 由Mac OS X定义的守护进程任务项")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("进入 "),t("code",[s._v("~/Library/LaunchAgents")]),s._v("，创建一个plist文件 "),t("code",[s._v("com.demo.plist")])]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{attrs:{class:"token prolog"}},[s._v('<?xml version="1.0" encoding="UTF-8"?>')]),s._v("\n"),t("span",{attrs:{class:"token doctype"}},[s._v('<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">')]),s._v("\n"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("plist")]),s._v(" "),t("span",{attrs:{class:"token attr-name"}},[s._v("version")]),t("span",{attrs:{class:"token attr-value"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{attrs:{class:"token punctuation"}},[s._v('"')]),s._v("1.0"),t("span",{attrs:{class:"token punctuation"}},[s._v('"')])]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dict")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token comment"}},[s._v("\x3c!-- Label唯一的标识 --\x3e")]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("Label"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.demo.plist"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token comment"}},[s._v("\x3c!-- 指定要运行的脚本 --\x3e")]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("ProgramArguments"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("array")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("/Users/demo/run.sh"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("array")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token comment"}},[s._v("\x3c!-- 指定要运行的时间 --\x3e")]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("StartCalendarInterval"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dict")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("Minute"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("integer")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("00"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("integer")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("Hour"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n      "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("integer")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("22"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("integer")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dict")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token comment"}},[s._v("\x3c!-- 标准输出文件 --\x3e")]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("StandardOutPath"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("/Users/demo/run.log"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token comment"}},[s._v("\x3c!-- 标准错误输出文件，错误日志 --\x3e")]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("StandardErrorPath"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("key")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("/Users/demo/run.err"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("string")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dict")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token tag"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("</")]),s._v("plist")]),t("span",{attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"加载命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#加载命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 加载命令")]),s._v(" "),t("p",[t("code",[s._v("launchctl load -w com.demo.plist")]),s._v(" 这样任务就加载成功了。")]),s._v(" "),t("p",[s._v("更多的命令：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 加载任务, -w 选项会将 plist 文件中无效的 key 覆盖掉，建议加上")]),s._v("\n$ launchctl load -w com.demo.plist\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 删除任务")]),s._v("\n$ launchctl unload -w com.demo.plist\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 查看任务列表, 使用 grep '任务部分名字' 过滤")]),s._v("\n$ launchctl list "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'com.demo'")]),s._v("\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 开始任务")]),s._v("\n$ launchctl start  com.demo.plist\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 结束任务")]),s._v("\n$ launchctl stop   com.demo.plist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("ul",[t("li",[s._v("如果任务被修改了，那么必须先 unload，然后重新 load")]),s._v(" "),t("li",[s._v("start 可以测试任务，这个是立即执行，不管时间到了没有")]),s._v(" "),t("li",[s._v("执行 start 和 unload 前，任务必须先 load 过，否则报错")]),s._v(" "),t("li",[s._v("stop 可以停止任务")])]),s._v(" "),t("h3",{attrs:{id:"plist部分参数说明："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#plist部分参数说明：","aria-hidden":"true"}},[s._v("#")]),s._v(" plist部分参数说明：")]),s._v(" "),t("ol",[t("li",[s._v("Label：对应的需要保证全局唯一性；")]),s._v(" "),t("li",[s._v("Program：要运行的程序；")]),s._v(" "),t("li",[s._v("ProgramArguments：命令语句")]),s._v(" "),t("li",[s._v("StartCalendarInterval：可以指定脚本在多少分钟、小时、天、星期几、月时间上执行，类似如crontab的中的设置，单个时间点使用dict，多个时间点使用 array、dict，包含下面的 key:")])]),s._v(" "),t("ul",[t("li",[s._v("Minute "),t("code",[s._v("<integer>")])]),s._v(" "),t("li",[s._v("Hour "),t("code",[s._v("<integer>")])]),s._v(" "),t("li",[s._v("Day "),t("code",[s._v("<integer>")])]),s._v(" "),t("li",[s._v("Weekday "),t("code",[s._v("<integer>")]),s._v(" (0 and 7 are Sunday)")]),s._v(" "),t("li",[s._v("Month "),t("code",[s._v("<integer>")])])]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[s._v("StartInterval：时间间隔，指定脚本每间隔多长时间（单位：秒）执行一次，与 StartCalendarInterval 使用其一，单位为秒")]),s._v(" "),t("li",[s._v("StandardInPath、StandardOutPath、StandardErrorPath：标准的输入输出错误文件，这里建议不要使用 .log 作为后缀，会打不开里面的信息。")]),s._v(" "),t("li",[s._v("定时启动任务时，如果涉及到网络，但是电脑处于睡眠状态，是执行不了的，这个时候，可以定时的启动屏幕就好了。")])]),s._v(" "),t("h2",{attrs:{id:"使用-crontab-设置定时任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-crontab-设置定时任务","aria-hidden":"true"}},[s._v("#")]),s._v(" 使用 crontab 设置定时任务")]),s._v(" "),t("p",[s._v("通过crontab 命令，我们可以在固定的间隔时间执行指定的系统指令或 shell script 脚本。时间间隔的单位可以是分钟、小时、日、月、周及以上的任意组合。这个命令非常适合周期性的日志分析或数据备份等工作。")]),s._v(" "),t("h3",{attrs:{id:"命令格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令格式","aria-hidden":"true"}},[s._v("#")]),s._v(" 命令格式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token function"}},[s._v("crontab")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-u user"),t("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{attrs:{class:"token function"}},[s._v("crontab")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-u user"),t("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -e "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" -l "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" -r "),t("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("-u user：用来设定某个用户的crontab服务；")]),s._v(" "),t("li",[s._v("file：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab。如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab。")]),s._v(" "),t("li",[s._v("-e：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。")]),s._v(" "),t("li",[s._v("-l：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。")]),s._v(" "),t("li",[s._v("-r：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。")]),s._v(" "),t("li",[s._v("-i：在删除用户的crontab文件时给确认提示。")])]),s._v(" "),t("h3",{attrs:{id:"crontab-文件格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab-文件格式","aria-hidden":"true"}},[s._v("#")]),s._v(" crontab 文件格式")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("分 时 日 月 星期 要运行的命令\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("第1列分钟1～59")]),s._v(" "),t("li",[s._v("第2列小时1～23（0表示子夜）")]),s._v(" "),t("li",[s._v("第3列日1～31")]),s._v(" "),t("li",[s._v("第4列月1～12")]),s._v(" "),t("li",[s._v("第5列星期0～7（0和7表示星期天）")]),s._v(" "),t("li",[s._v("第6列要运行的命令")])]),s._v(" "),t("h3",{attrs:{id:"备份-恢复-crontab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#备份-恢复-crontab","aria-hidden":"true"}},[s._v("#")]),s._v(" 备份/恢复 crontab")]),s._v(" "),t("p",[s._v("可以定时备份 crontab 以防误删操作")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 备份")]),s._v("\n"),t("span",{attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -l "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token variable"}},[s._v("$HOME")]),s._v("/.mycron\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 恢复")]),s._v("\n"),t("span",{attrs:{class:"token function"}},[s._v("crontab")]),s._v(" "),t("span",{attrs:{class:"token variable"}},[s._v("$HOME")]),s._v("/.mycron\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"定时实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定时实例","aria-hidden":"true"}},[s._v("#")]),s._v(" 定时实例")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 每1分钟执行一次myCommand")]),s._v("\n* * * * * myCommand\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 每小时的第3和第15分钟执行")]),s._v("\n3,15 * * * * myCommand\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 在上午8点到11点的第3和第15分钟执行")]),s._v("\n3,15 8-11 * * * myCommand\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 每隔两天的上午8点到11点的第3和第15分钟执行")]),s._v("\n3,15 8-11 */2  *  * myCommand\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 每周一上午8点到11点的第3和第15分钟执行")]),s._v("\n3,15 8-11 * * 1 myCommand\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 晚上11点到早上7点之间，每隔一小时重启smb")]),s._v("\n* 23-7/1 * * * /etc/init.d/smb restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"注意清理系统用户的邮件日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意清理系统用户的邮件日志","aria-hidden":"true"}},[s._v("#")]),s._v(" 注意清理系统用户的邮件日志")]),s._v(" "),t("p",[s._v("每条任务调度执行完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行，因此，将每条任务进行重定向处理非常重要。 例如，可以在crontab文件中设置如下形式，忽略日志输出:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("0 */3 * * * /usr/local/apache2/apachectl restart "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v("/dev/null 2"),t("span",{attrs:{class:"token operator"}},[s._v(">")]),t("span",{attrs:{class:"token operator"}},[s._v("&")]),s._v("1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/4addd9b455f2",target:"_blank",rel:"noopener noreferrer"}},[s._v("Mac中的定时任务利器：launchctl"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"http://codingpub.github.io/2016/10/27/OS-X-%E6%B7%BB%E5%8A%A0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/",target:"_blank",rel:"noopener noreferrer"}},[s._v("OS X 添加定时任务"),t("OutboundLink")],1)])])},[],!1,null,null,null);r.options.__file="MacOS_Launchctl.md";a.default=r.exports}}]);