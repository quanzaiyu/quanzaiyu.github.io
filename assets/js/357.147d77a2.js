(window.webpackJsonp=window.webpackJsonp||[]).push([[357],{801:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"nginx-配置ssl证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-配置ssl证书","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx 配置ssl证书")]),t._v(" "),a("p",[t._v("要让网站拥有 HTTPS (Hypertext Transfer Protocol Secure) 的能力, 需要在服务器中配置 SSL (Secure Socket Layer) 证书。")]),t._v(" "),a("h2",{attrs:{id:"证书申请"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#证书申请","aria-hidden":"true"}},[t._v("#")]),t._v(" 证书申请")]),t._v(" "),a("p",[t._v("首先是证书的申请, 有好几种方式, 很多证书是要收费的, 我们可以使用"),a("a",{attrs:{href:"https://common-buy.aliyun.com/?spm=5176.7968328.1266638..333a1232CdEgOz&commodityCode=cas#/buy",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云云盾服务"),a("OutboundLink")],1),t._v("进行证书申请。")]),t._v(" "),a("imgLink",{attrs:{src:"date/20181130/001.png"}}),t._v(" "),a("p",[t._v("或者"),a("a",{attrs:{href:"https://buy.cloud.tencent.com/ssl",target:"_blank",rel:"noopener noreferrer"}},[t._v("腾讯云"),a("OutboundLink")],1),t._v("进行申请")]),t._v(" "),a("imgLink",{attrs:{src:"date/20181130/002.png"}}),t._v(" "),a("h2",{attrs:{id:"在nginx中配置ssl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在nginx中配置ssl","aria-hidden":"true"}},[t._v("#")]),t._v(" 在Nginx中配置SSL")]),t._v(" "),a("p",[t._v("下载下来的文件包括:")]),t._v(" "),a("imgLink",{attrs:{src:"date/20181130/003.png"}}),t._v(" "),a("p",[t._v("注意到有一个 pem 文件和一个 key 文件, 分别将其路径配置到 "),a("code",[t._v("ssl_certificate")]),t._v(" 和 "),a("code",[t._v("ssl_certificate_key")]),t._v(" 字段, 比如:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen       443 ssl http2 default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":443 ssl http2 default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name  _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    root         /usr/share/nginx/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    ssl_certificate "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/root/.ssl/ssl.pem"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ssl_certificate_key "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/root/.ssl/ssl.key"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ssl_session_cache shared:SSL:1m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ssl_session_timeout  10m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ssl_ciphers HIGH:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("aNULL:"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("MD5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ssl_prefer_server_ciphers on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Load configuration files for the default server block.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# include /etc/nginx/default.d/*.conf;")]),t._v("\n\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    error_page 404 /404.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /40x.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    error_page 500 502 503 504 /50x.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /50x.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("如果是 crt 证书, 同样的配置:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ssl_certificate "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/root/.ssl/ssl.crt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nssl_certificate_key "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/root/.ssl/ssl.key"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("重新加载配置:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ nginx -s reload\n")])])]),a("p",[t._v("在防火墙中打开指定端口:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ firewall-cmd --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("443/tcp\n")])])]),a("p",[t._v("ok, 一切就绪, 浏览器中访问试试:")]),t._v(" "),a("imgLink",{attrs:{src:"date/20181130/004.png"}})],1)},[],!1,null,null,null);e.options.__file="HTTPS.md";s.default=e.exports}}]);