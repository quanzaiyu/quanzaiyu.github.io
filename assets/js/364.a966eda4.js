(window.webpackJsonp=window.webpackJsonp||[]).push([[364],{802:function(s,a,t){"use strict";t.r(a);var n={props:["slot-key"]},e=t(0),p=Object(e.a)(n,function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.slotKey}},[t("h1",{attrs:{id:"静态代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#静态代理","aria-hidden":"true"}},[s._v("#")]),s._v(" 静态代理")]),s._v(" "),t("p",[s._v("在 tp5.1，引入了 Facade 类，又叫门面类，如果想静态访问一个类中的动态方法，可以给这个类套一层静态马甲，实现静态访问，核心文件位于 "),t("code",[s._v("thinkphp/library/think/Facade.php")]),s._v(" 。")]),s._v(" "),t("p",[s._v("系统的 "),t("code",[s._v("facade")]),s._v(" 类位于 "),t("code",[s._v("thinkphp/library/think/facade")]),s._v(" 中，系统封装的 facade 位于 "),t("code",[s._v("thinkphp/base.php")]),s._v(" 文件中。")]),s._v(" "),t("p",[s._v("如果想静态调用一个动态方法，需要给当前的类绑定一个静态代理类。")]),s._v(" "),t("p",[s._v("例子同依赖注入中的Demo类，修改 Demo 类  :")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),t("span",{attrs:{class:"token package"}},[s._v("app"),t("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("common")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{attrs:{class:"token class-name"}},[s._v("Demo")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("function")]),s._v(" sayHello "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token variable"}},[s._v("$name")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'qzy'")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'Hello '")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{attrs:{class:"token variable"}},[s._v("$name")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("创建一个 facade 管理目录 "),t("code",[s._v("application/facade")]),s._v(" ，新建一个文件 "),t("code",[s._v("Demo.php")]),s._v(" :")]),s._v(" "),t("p",[t("code",[s._v("application/facade/Demo.php")])]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),t("span",{attrs:{class:"token package"}},[s._v("app"),t("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("facade")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{attrs:{class:"token class-name"}},[s._v("Demo")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{attrs:{class:"token class-name"}},[t("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("think"),t("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Facade")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("getFacadeClass")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'app\\common\\Demo'")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("这个文件中，继承了 Facade 类，通过重写父类方法 getFacadeClass() 进行代理，返回的是需要代理的类名。")]),s._v(" "),t("p",[s._v("在 index 控制器中加入方法 :")]),s._v(" "),t("p",[t("code",[s._v("application/index/Index.php")])]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("function")]),s._v(" getMethodAsStatic "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{attrs:{class:"token keyword"}},[s._v("return")]),s._v(" \\"),t("span",{attrs:{class:"token package"}},[s._v("app"),t("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("facade"),t("span",{attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Demo")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{attrs:{class:"token function"}},[s._v("sayHello")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token single-quoted-string string"}},[s._v("'xiaoyu'")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("此时，访问 "),t("code",[s._v("http://www.my-tp5.com/index.php/index/index/getMethodAsStatic")]),s._v(" 可以看到结果。")])])},[],!1,null,null,null);p.options.__file="README.md";a.default=p.exports}}]);